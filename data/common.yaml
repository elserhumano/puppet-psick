---
psick::manage: true
psick::auto_prereq: true
psick::auto_conf: 'none'
psick::is_cluster: false
psick::primary_ip_address: "%{facts.networking.ip}"
psick::mgmt_interface: "%{facts.networking.primary}"

psick::enable_firstrun: false

psick::tp:
  cli_enable: false
  test_enable: false
  puppi_enable: false
  debug: false
  data_module: tinydata
  config_file_notify: true
  config_file_require: true
  config_dir_notify: true
  config_dir_require: true

psick::settings: {}
psick::servers: {}

psick::firewall:
  manage: false
  enable: true
  classes: {}

psick::php::module_prefix: php-
psick::php::pear_module_prefix: pear
psick::php::devel::package: php-devel

psick::monitor:
  manage: true
  enable: true
  hostname: "%{facts.networking.fqdn}"
  ip: "%{facts.networking.ip}"
  interface: "%{facts.networking.primary}"
  classes: {}

# psick::firewall::iptables
psick::firewall::iptables::package_name: 'iptables'
psick::firewall::iptables::service_name: 'iptables'
psick::firewall::iptables::service_name_v6: 'ip6tables'
psick::firewall::iptables::config_file_path: '/etc/sysconfig/iptables'
psick::firewall::iptables::config_file_path_v6: '/etc/sysconfig/ip6tables'

# psick::hardening::packages
psick::hardening::packages::packages_to_remove: []
psick::hardening::packages::packages_default: []
psick::hardening::services::services_to_remove: []
psick::hardening::services::services_default: []

# psick::hardware::hp
psick::hardware::hp::packages: []

# psick::icinga2
psick::icinga2::ido_backend: mysql
psick::icinga2::ido_settings:
  database: 'icinga2'
  user: 'icinga2'
  password: 'icinga2pw!'
  grant: 'SELECT, INSERT, UPDATE, DELETE, DROP, CREATE VIEW, CREATE, INDEX, EXECUTE, ALTER'
  create_db: true
  host: 'localhost'

psick::icinga2::host_default_params:
  target: '/etc/icinga2/conf.d/hosts.conf'
  import:
    - generic-host
  vars:
    os: Linux
    disks:
      disk: {}
      disk:
        /:
          disk_partitions: '/'
    notification["mail"]:
      groups:
        - icingaadmins

psick::icinga2::user_default_params:
  target: '/etc/icinga2/conf.d/users.conf'
  import:
    - generic-user

psick::icinga2::usergroup_default_params:
  target: '/etc/icinga2/conf.d/users.conf'

psick::icinga2::service_default_params:
  target: '/etc/icinga2/conf.d/services.conf'
  import:
    - generic-service

psick::icinga2::service_hash:
  ping4:
    apply: true
    check_command: ping4
    assign:
      - host.address
  ping6:
    apply: true
    check_command: ping6
    assign:
      - host.address6
  disks:
    apply: 'disk => config in host.vars.disks'
    check_command: disk
    vars:
      - + config
  ssh:
    apply: true
    check_command: ssh
    assign:
      - (host.address || host.address6) && host.vars.os == Linux
  vhosts:
    apply: 'http_vhost => config in host.vars.http_vhosts'
    check_command: http
    vars:
      - + config
  load:
    apply: true
    check_command: load
    assign:
      - host.name == NodeName
    vars:
      backup_downtime: "02:00-03:00"
  procs:
    apply: true
    check_command: procs
    assign:
      - host.name == NodeName
  swap:
    apply: true
    check_command: swap
    assign:
      - host.name == NodeName
  users:
    apply: true
    check_command: users
    assign:
      - host.name == NodeName

psick::icinga2::usergroup_hash:
  icingaadmins:
    display_name: 'Icinga2 Admins'

# psick::icingaweb2
# psick::icingaweb2
psick::icingaweb2::db_backend: mysql
psick::icingaweb2::db_settings:
  database: 'icingaweb2'
  user: 'icingaweb2'
  password: 'icingaweb2pw!'
  grant: 'ALL'
  create_db: true
  host: 'localhost'
psick::icingaweb2::director_db_settings:
  database: 'director'
  user: 'director'
  password: 'directorpw!'
  grant: 'ALL'
  create_db: true
  host: 'localhost'
psick::icingaweb2::php_fpm_name: 'php-fpm'
psick::icingaweb::extra_modules:
  doc: {}

# psick::monitor::ganglia
psick::monitor::ganglia::packages: []

# psick::monitor::snmpd
psick::monitor::snmpd::extra_packages: []

# psick::puppet::postrun
psick::puppet::postrun::puppet_conf_path: '/etc/puppetlabs/puppet/puppet.conf'

# Deep merge lookups for the following keys:
lookup_options:
  psick::settings:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::profiles:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::servers:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::tp:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::firewall:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::monitor:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::gitlab::cli::config_hash:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::hosts::file::extra_hosts:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::network::routes:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::network::interfaces:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::windows::features::install:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::windows::features::defaults:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::windows::registry::keys:
    merge:
      strategy: deep
      knockout_prefix: "--"
  psick::windows::registry::defaults:
    merge:
      strategy: deep
      knockout_prefix: "--"
# Regular expressions to enable deep merge on all params ending with _hash and _classes
  "^psick::(.*)::(.*)_hash$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::(.*)::(.*)::(.*)_hash$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::(.*)::(.*)_classes$":
    merge:
      strategy: deep
      merge_hash_arrays: true
      knockout_prefix: "--"
  "^psick::(.*)::(.*)::(.*)_classes$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::repo::(.*)_repos$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::(.*)::(.*)_list$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::firewall::iptables::(.*)_rules$":
    merge:
      strategy: deep
      knockout_prefix: "--"
  "^psick::firewall::iptables::(.*)_rules_v6$":
    merge:
      strategy: deep
      knockout_prefix: "--"

